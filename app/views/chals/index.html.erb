
<div class="pathLocation add_shadow">
  <p>LISTING CHALLENGES</p> 
</div>  

<!-- If logged in add challenge -->
<% if logged_in? %>
  <%= link_to new_chal_path do %>
  <div class = "col-md-12">
    <div class = "col-md-12 mid add_hover add_shadow small_fix">
          <p><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add challenge</p>
    </div>
  </div>
  <% end %>
<% end %>
  
<% ids = 0 %>
<div class = "col-md-12">
  <% @chals.each do |chal| %>
    <% ids += 1 %>
      <div class = "chals_container add_shadow add_hover" id = <%= ids %>>
        
        <!-- If logged in or admin edit / delete challenge -->
        <% if logged_in? && (current_user == chal.user || current_user.admin?) %>
          <div class = "art_control">
            <%= link_to edit_chal_path(chal) do %>
              <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
            <% end %>
            <%= link_to chal, method: :delete, data: { confirm: 'Are you sure?' } do %>
              <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
            <% end %>
          </div>
        <% end %>
          
        
        <%= link_to chal.cat.name, cat_chals_path(chal.cat), :class=> "label label-primary pull-right", :style => "color: white;" %>
         
        <%= link_to chal do %>
        <div>
          
          <div class = "tile_header">
            <div class = "">
              <div><div class = "how_i">Let's treat </div><div class = "treat"><%= chal.name %></div></div>
            </div>
          </div>
  
          <div class="tile_description">
            <p><b>Treatment</b> <%= " : "+chal.reg.split[0...40].join(' ')+" ... " %></p>
          </div>
          
          
          <div class = "tile_duration">
            <p><b><%= "Duration: "+(chal.dur).to_s+" day(s)" %></b></p>
          </div>
        </div>
        <% end %>
        
        <%= link_to chal do %>
          <div class = "tile_details pull-left">
                by: <%= chal.user.username %>, <%= time_ago_in_words(chal.created_at) %> ago, last updated <%= time_ago_in_words(chal.updated_at) %> ago
          </div>
        <% end %>
        
        <div class = "pull-right" style = "margin-right: 10px;">
            <%= link_to like_chal_path(chal, like: true), method: :post do %>
              <i class="glyphicon glyphicon-thumbs-up"></i>
            <% end %>
            <%= chal.thumb_up_total %>
            &nbsp
            <%= link_to like_chal_path(chal, like: false), method: :post do %>
              <i class="glyphicon glyphicon-thumbs-down"></i>
            <% end %>
            
            <%= chal.thumb_dw_total %> 
            &nbsp
            <span class="glyphicon glyphicon-comment" aria-hidden="true"></span> <%= chal.comments %>
          </div>
        
      </div>
    
    <script> document.getElementById(<%= ids %>).style.backgroundColor = "#" + rdmColor(<%= chal.name.size %>); </script>
    
  <% end %>
   </div>